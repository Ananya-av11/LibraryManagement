{% extends 'userhome.html' %}
{% block content %}

<center>
    {% if messages %}
    <div class="alert alert-danger alert-dismissible" style="width: 50%; margin-bottom: 15px; font-weight: bold;">
        <button type="button" class="close" data-dismiss="alert">&times;</button>
        {% for message in messages %}
            {{ message }}
        {% endfor %}
    </div>
    {% endif %}
</center>

<h3 class="text-center mt-3 mb-3">Rent Your Book</h3>
<div class="container mb-3" style="max-width: 500px;">
    {% if rentitems %}
    <form action="{% url 'rent_info' rentitems.id %}" method="post" enctype="multipart/form-data" onchange="calculateDueDate()">
        {% csrf_token %}
    <div class="row">
        <div class="col-md-7">
        <div class="form-group">
            <input type="text" class="form-control" name="bname" value="{{rentitems.bookname}}" readonly>
        </div>
        <div class="form-group">
            <input type="text" class="form-control" name="author" value="{{rentitems.authorname}}" readonly>
        </div>
        <div class="form-group">
            <input type="text" class="form-control" name="desc" value="{{rentitems.description}}" readonly>
        </div>
        <div class="form-group">
            <input type="text" class="form-control" name="bprice" value="{{rentitems.price}}" readonly>
        </div>
        </div>
        <div class="col">
        <div class="form-group">
            <img src="{{rentitems.bookimage.url}}" class="mt-3" alt="" width="175" height="150">
        </div>
        </div>
    </div>
    
        <div class="form-group">
            <label for="rental_period" class="form-label"><strong>Select Rental Period</strong></label>
            <select id="rental_period" name="rental_period" class="form-control">
                <option value="" selected>Select Rental Period</option>
                <option value="7">1 Week</option>
                <option value="14">2 Weeks</option>
                <option value="30">1 Month</option>
            </select>
        </div>
        
        
        <div class="form-group">
            <h6 class="mt-2"><strong>Due Date: </strong><span id="due_date"></span></h6>
        </div>
        
        <div class="form-group">
            <label for="rental_period" class="form-label"><strong>Quantity</strong></label>
            <input type="number" name="quantity" class="form-control" >
        </div>
        <div class="form-group">
            <button type="submit" class="btn btn-primary">Confirm</button>
        </div>

    </form>
    {% else %}
        <div style="width: 100%; height: 300px;">
            <p class="text-center"><b>No rented books found.</b></p>
        </div>
    {% endif %}
</div>

<script>
    function calculateDueDate(){
        let rentalperiod=parseInt(document.getElementById('rental_period').value);
        let today=new Date();
        today.setDate(today.getDate()+rentalperiod);
        let duedt=today.toISOString().split('T')[0];
        document.getElementById('due_date').innerHTML=duedt;
    }
    document.addEventListener('DOMContentLoader',calculateDueDate);
</script>



{% endblock %}
